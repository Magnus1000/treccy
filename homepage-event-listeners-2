<!-- ############################################ EVENT LISTENERS 2 ############################################ -->
<script>
// Function to get element value by ID
function getElementValue(id) {
  return document.getElementById(id).value;
}

// Update URL params with filters
function updateURLWithFilters() {
  // Get discipline values from checked checkboxes
  const selectedDisciplines = Array.from(document.querySelectorAll('.disciplinefilter_checkbox'))
    .filter(checkbox => checkbox.checked)
    .map(checkbox => checkbox.getAttribute('filter-value'));

  // Log the selected disciplines to the console
  console.log('Selected discipline filters:', selectedDisciplines);

  // Filters collection
  const filters = {
    minDist: getElementValue('minimum-distance'),
    maxDist: getElementValue('maximum-distance'),
    locationRange: getElementValue('location_range'),
    fromDate: getElementValue('dateFrom'),
    toDate: getElementValue('dateTo'),
    type: document.querySelector('input[name="type"]:checked')?.value,
    location: getElementValue('location-search-bar'),
    lat: document.getElementById('location-search-bar').getAttribute('data-lat'),
    lng: document.getElementById('location-search-bar').getAttribute('data-lon'),
  };

  let params = new URLSearchParams();

  // Add selected disciplines to URL parameters
  selectedDisciplines.forEach((discipline, index) => {
    params.append(`discipline${index}`, discipline);
  });

  // Add other filters to URL parameters
  for (const [key, value] of Object.entries(filters)) {
    if (value) params.set(key, value);
  }

  // Log the final parameters to the console
  console.log('Final URL parameters:', params.toString());

  // Update the URL without causing a page reload
  history.pushState({}, '', '?' + params.toString());
}


// Add an event listener to the form with id="filterForm"
document.getElementById('filterForm').addEventListener('submit', function(event) {
  // Prevent the default form submission behavior
  event.preventDefault();

  // Call the function to update URL with filters
  updateURLWithFilters();
});

</script>
