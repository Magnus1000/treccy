<script>
// Listen for clicks on elements with class '.heart-empty' or '.heart-full'
document.addEventListener('click', async function(event) {
  
  console.log('Document was clicked');  // Debugging line
  
    // Check if the clicked element is a heart SVG
  if (event.target.matches('img')) {
    console.log('Image was clicked');  // Debugging line
    
  // Check if the clicked element is a heart SVG
  if (event.target.matches('.heart-empty, .heart-full')) {
    
    // Get the closest race-card parent to identify which card was clicked
    const raceCard = event.target.closest('.race-card');
    const raceId = raceCard.getAttribute('data-race-id');
    
    // Toggle SVG visibility based on existing favorite state
    const heartEmpty = raceCard.querySelector('.heart-empty');
    const heartFull = raceCard.querySelector('.heart-full');
    
    if (favoritedRaces.includes(raceId)) {
      // Remove from favorites
      favoritedRaces = favoritedRaces.filter(id => id !== raceId);
      heartEmpty.style.display = 'block';
      heartFull.style.display = 'none';
    } else {
      // Add to favorites
      favoritedRaces.push(raceId);
      heartEmpty.style.display = 'none';
      heartFull.style.display = 'block';
    }
    
    // Fetch the current Memberstack member JSON data
    const member = await window.$memberstackDom.getMemberJSON();
    
    // Update the JSON data with the new list of favorited races
    member.data.favoritedRaces = favoritedRaces;
    
    // Update the member JSON data on Memberstack
    await window.$memberstackDom.updateMemberJSON({ json: member.data });
    
    // Log for debugging
    console.log(`Member JSON updated with favorited races: ${favoritedRaces}`);
  }
});
</script>
